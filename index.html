<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è»¢ç”Ÿã®ç« 2 æœŸå¾…å€¤è¨ˆç®—</title>

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:#f4f6f8;
  padding:12px;
}
.box{
  background:#fff;
  border-radius:12px;
  padding:15px;
  box-shadow:0 2px 8px rgba(0,0,0,.08);
  max-width:480px;
  margin:auto;
}
h2{
  text-align:center;
  margin:4px 0 12px;
}
label{
  font-weight:600;
  display:block;
  margin-top:10px;
}
input,select,button{
  width:100%;
  padding:10px;
  font-size:16px;
  border-radius:8px;
  border:1px solid #ccc;
  box-sizing:border-box;
}
button{
  margin-top:12px;
  background:#007aff;
  color:#fff;
  border:none;
  font-weight:bold;
}
.result{
  margin-top:12px;
  background:#fafafa;
  border-radius:10px;
  padding:12px;
  line-height:1.6;
  font-size:15px;
}
.good{color:#d00000;font-weight:bold;}
.mid{color:#ff9500;font-weight:bold;}
.bad{color:#666;}
</style>
</head>

<body>

<div class="box">
<h2>è»¢ç”Ÿã®ç« 2 æœŸå¾…å€¤è¨ˆç®—</h2>

<label>ç¾åœ¨ã‚ã¹ã—</label>
<input type="number" id="current" placeholder="ä¾‹ï¼š820">

<label>æ›é‡‘ç‡</label>
<select id="rate">
  <option value="20">ç­‰ä¾¡ï¼ˆ20å††ï¼‰</option>
  <option value="56">56æšäº¤æ›ï¼ˆ17.86å††ï¼‰</option>
</select>

<label>ç¤ºå”†ãƒ©ãƒ³ãƒ—</label>
<select id="lamp">
  <option value="none">ãªã—</option>
  <option value="white">ç™½ï¼ˆAç¤ºå”†ï¼‰</option>
  <option value="blue">é’ï¼ˆBç¤ºå”†ï¼‰</option>
  <option value="green">ç·‘ï¼ˆCç¤ºå”†ï¼‰</option>
  <option value="red">èµ¤ï¼ˆå¤©å›½ç¤ºå”†ï¼‰</option>
  <option value="rainbow">è™¹ï¼ˆå¤©å›½æ¿ƒåšï¼‰</option>
</select>

<button onclick="calc()">è¨ˆç®—ã™ã‚‹</button>

<div id="result" class="result"></div>
</div>

<script>
const CEILING = 1536;
const COST = 3.0; // å®Ÿæˆ¦å€¤
const AVG_PAY = { A:580, B:610, C:660, T:720 };

const lampTable = {
  none:{A:0.49,B:0.22,C:0.20,T:0.09},
  white:{A:0.65,B:0.20,C:0.10,T:0.05},
  blue:{A:0.25,B:0.45,C:0.20,T:0.10},
  green:{A:0.10,B:0.30,C:0.45,T:0.15},
  red:{A:0.05,B:0.15,C:0.30,T:0.50},
  rainbow:{A:0.00,B:0.05,C:0.20,T:0.75}
};

function coinValue(rate){
  return rate==="56" ? 1000/56 : 20;
}

function hitRate(mode,a){
  if(mode==="A"){
    if(a<193) return 0.05;
    if(a<256) return 0.35;
    if(a<1217) return 0.12;
    return 0.90;
  }
  if(mode==="B"){
    if(a<193) return 0.08;
    if(a<256) return 0.45;
    if(a<705) return 0.15;
    if(a<768) return 0.65;
    if(a<833) return 0.30;
    return 0.95;
  }
  if(mode==="C"){
    if(a<193) return 0.10;
    if(a<256) return 0.50;
    if(a<513) return 0.18;
    return 0.95;
  }
  if(mode==="T"){
    if(a<128) return 0.85;
    return 1.00;
  }
}

function judge(ev){
  if(ev>=3000) return "<span class='good'>ğŸ”¥ ç¥å°</span>";
  if(ev>=1500) return "<span class='good'>â— æ‰“ã¤</span>";
  if(ev>=500)  return "<span class='mid'>â—‹ å¯</span>";
  if(ev>=0)    return "<span class='mid'>â–³ æ§˜å­è¦‹</span>";
  return "<span class='bad'>âœ• æ¨ã¦</span>";
}

function calc(){
  const a = Number(document.getElementById("current").value);
  if(!a){ alert("ç¾åœ¨ã‚ã¹ã—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"); return; }

  const rate = document.getElementById("rate").value;
  const lamp = document.getElementById("lamp").value;

  const coin = coinValue(rate);
  const invest = Math.max(0,(CEILING-a)*COST);

  let ev=0,payout=0;

  for(const m in lampTable[lamp]){
    const p = lampTable[lamp][m];
    const hit = hitRate(m,a);
    payout += AVG_PAY[m]*coin*hit*p;
    ev += (AVG_PAY[m]*coin*hit - invest)*p;
  }

  const remain = CEILING - a;
  const time = Math.max(0, Math.round(remain/23)); // ç´„23ã‚ã¹ã—/åˆ†

  ev = Math.round(ev);
  payout = Math.round(payout);

  document.getElementById("result").innerHTML =
  `<b>${a} ã‚ã¹ã—</b><br>
   å¤©äº•ã¾ã§ï¼šç´„<b>${remain}</b> ã‚ã¹ã—<br>
   æƒ³å®šæ™‚é–“ï¼šç´„<b>${time}åˆ†</b><br>
   å¹³å‡æŠ•è³‡ï¼šç´„<b>${Math.round(invest)}å††</b><br>
   æœŸå¾…å›åï¼š${payout}å††<br>
   æœŸå¾…å€¤ï¼š<b>${ev}å††</b><br>
   åˆ¤å®šï¼š${judge(ev)}`;
}
</script>

</body>
</html>