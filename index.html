<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>北斗 転生の章2 AI期待値ツール</title>

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,"Hiragino Kaku Gothic ProN",Meiryo,sans-serif;
  background:#f4f6fb;
  margin:0;
  padding:10px;
}
.box{
  background:#fff;
  border-radius:10px;
  padding:14px;
  max-width:480px;
  margin:auto;
  box-shadow:0 2px 6px rgba(0,0,0,.1);
}
h1{
  font-size:18px;
  text-align:center;
  margin-bottom:12px;
}
label{
  font-size:14px;
  font-weight:bold;
}
input,select,button{
  width:100%;
  padding:8px;
  font-size:16px;
  border-radius:6px;
  border:1px solid #ccc;
  margin-bottom:8px;
  box-sizing:border-box;
}
button{
  background:#007aff;
  color:#fff;
  border:none;
  font-weight:bold;
}
.result{
  background:#f1f3f7;
  padding:10px;
  border-radius:8px;
  margin-top:10px;
  font-size:14px;
}
.good{color:#d60000;font-weight:bold;}
</style>
</head>

<body>
<div class="box">
<h1>北斗 転生の章2<br>AI期待値 × モード推測</h1>

<label>現在あべし</label>
<input id="abeshi" type="number" value="0">

<label>枠ランプ示唆</label>
<select id="lamp">
  <option value="none">なし</option>
  <option value="yellow">黄緑（B以上）</option>
  <option value="yellow_blink">黄緑点滅（C以上）</option>
  <option value="gold">金（B以上強）</option>
  <option value="gold_blink">金点滅（C以上強）</option>
  <option value="purple">紫（B以上＋設定示唆）</option>
</select>

<label>換金率</label>
<select id="rate">
  <option value="5">5.0枚</option>
  <option value="5.6">5.6枚</option>
  <option value="6">6.0枚</option>
</select>

<button onclick="calc()">計算</button>

<div id="result" class="result"></div>
</div>

<script>
function calc(){

  let abeshi = Number(document.getElementById("abeshi").value);
  let lamp = document.getElementById("lamp").value;
  let rate = Number(document.getElementById("rate").value);

  let mode = {A:0.52,B:0.24,C:0.18,T:0.06};

  if(lamp=="yellow") mode={A:0.05,B:0.55,C:0.30,T:0.10};
  if(lamp=="yellow_blink") mode={A:0.01,B:0.20,C:0.60,T:0.19};
  if(lamp=="gold") mode={A:0.01,B:0.60,C:0.30,T:0.09};
  if(lamp=="gold_blink") mode={A:0.00,B:0.15,C:0.65,T:0.20};
  if(lamp=="purple") mode={A:0.00,B:0.55,C:0.35,T:0.10};

  if(abeshi>=350) mode.A*=0.8;
  if(abeshi>=550) mode.A*=0.6;
  if(abeshi>=750) mode.A*=0.45;
  if(abeshi>=900) mode.A*=0.30;

  let total=mode.A+mode.B+mode.C+mode.T;
  for(let k in mode){ mode[k]/=total; }

  let avgPay =
    mode.A*520 +
    mode.B*610 +
    mode.C*720 +
    mode.T*850;

  let remain = Math.max(0,1536-abeshi);
  let invest = remain*21;
  let time = remain/23;

  let ev = avgPay*(50/rate)-invest;
  let hourly = ev/(time/60);

  let stop="";
  if(mode.T>0.18) stop="天国期待 → 128まで";
  else if(mode.C>0.45) stop="C濃厚 → 576まで";
  else if(mode.B>0.45) stop="B濃厚 → 896まで";
  else stop="示唆弱 → 即ヤメ";

  document.getElementById("result").innerHTML=`
  【モード期待度】<br>
  A:${(mode.A*100).toFixed(1)}% / B:${(mode.B*100).toFixed(1)}% / 
  C:${(mode.C*100).toFixed(1)}% / 天国:${(mode.T*100).toFixed(1)}%<br><br>

  天井まで：${remain}あべし（約${Math.round(time)}分）<br>
  平均投資：約${Math.round(invest)}円<br>
  平均獲得：約${Math.round(avgPay)}枚<br>

  <span class="good">期待値：${Math.round(ev)}円</span><br>
  時給：${Math.round(hourly)}円/h<br><br>

  【AIヤメ時】${stop}
  `;
}
</script>
</body>
</html>